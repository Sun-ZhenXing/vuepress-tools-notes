import{_ as e,r as o,o as r,c,b as s,a as l,w as p,d as n,e as D}from"./app-e1d9226b.js";const t={},i=s("h1",{id:"docker-部署-wordpress",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#docker-部署-wordpress","aria-hidden":"true"},"#"),n(" Docker 部署 WordPress")],-1),d={class:"table-of-contents"},y=D(`<h2 id="_1-docker-创建容器" tabindex="-1"><a class="header-anchor" href="#_1-docker-创建容器" aria-hidden="true">#</a> 1. Docker 创建容器</h2><p>确保已经安装 Docker，如果没有安装请搜索在你的系统上安装 Docker，当前测试系统是 Debian 11.5。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#6A9955;"># 安装 MySQL 5.7</span></span>
<span class="line"><span style="color:#DCDCAA;">docker</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">container</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">run</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">-d</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">--name</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">wordpressdb</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">--env</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">MYSQL_ROOT_PASSWORD=</span><span style="color:#B5CEA8;">123456</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">--env</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">MYSQL_DATABASE=wordpress</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#CE9178;">mysql:5.7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># 安装 WordPress，把文件保存在当前路径的 ./wordpress 路径下</span></span>
<span class="line"><span style="color:#6A9955;"># 将 8081 可以改为你需要暴露的端口</span></span>
<span class="line"><span style="color:#DCDCAA;">docker</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">container</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">run</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">-d</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">-p</span><span style="color:#D4D4D4;"> </span><span style="color:#B5CEA8;">8081</span><span style="color:#CE9178;">:80</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">--name</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">wordpress</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">--env</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">WORDPRESS_DB_PASSWORD=</span><span style="color:#B5CEA8;">123456</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">--link</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">wordpressdb:mysql</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">--volume</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;</span><span style="color:#9CDCFE;">$PWD</span><span style="color:#CE9178;">/wordpress&quot;:/var/www/html</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#CE9178;">wordpress</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后编辑 <code>./wordpress/wp-config.php</code> 文件中的用户名和密码：</p><div class="language-php" data-ext="php"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">define</span><span style="color:#D4D4D4;">( </span><span style="color:#CE9178;">&#39;DB_NAME&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#DCDCAA;">getenv_docker</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;WORDPRESS_DB_NAME&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;wordpress&#39;</span><span style="color:#D4D4D4;">) );</span></span>
<span class="line"><span style="color:#DCDCAA;">define</span><span style="color:#D4D4D4;">( </span><span style="color:#CE9178;">&#39;DB_USER&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#DCDCAA;">getenv_docker</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;WORDPRESS_DB_USER&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;root&#39;</span><span style="color:#D4D4D4;">) );</span></span>
<span class="line"><span style="color:#DCDCAA;">define</span><span style="color:#D4D4D4;">( </span><span style="color:#CE9178;">&#39;DB_PASSWORD&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#DCDCAA;">getenv_docker</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;WORDPRESS_DB_PASSWORD&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;123456&#39;</span><span style="color:#D4D4D4;">) );</span></span>
<span class="line"></span></code></pre></div><p>打开地址即可即可使用 WordPress。</p><h2 id="_2-修改最大上传限制" tabindex="-1"><a class="header-anchor" href="#_2-修改最大上传限制" aria-hidden="true">#</a> 2. 修改最大上传限制</h2><p>修改的 PHP 配置，进入容器：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">docker</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">exec</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-it</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">wordpress</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">/bin/bash</span></span>
<span class="line"></span></code></pre></div><p>下面的命令执行在 Docker 容器内：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">cd</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">/usr/local/etc/php/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># 查看默认最大限制</span></span>
<span class="line"><span style="color:#DCDCAA;">cat</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">php.ini-production</span><span style="color:#D4D4D4;"> | </span><span style="color:#DCDCAA;">grep</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">upload_max_filesize</span></span>
<span class="line"><span style="color:#DCDCAA;">cat</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">php.ini-production</span><span style="color:#D4D4D4;"> | </span><span style="color:#DCDCAA;">grep</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">post_max_size</span></span>
<span class="line"><span style="color:#DCDCAA;">cat</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">php.ini-production</span><span style="color:#D4D4D4;"> | </span><span style="color:#DCDCAA;">grep</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">memory_limit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># 生成 php.ini</span></span>
<span class="line"><span style="color:#DCDCAA;">cp</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">php.ini-production</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">php.ini</span></span>
<span class="line"><span style="color:#DCDCAA;">sed</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-i</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;s/upload_max_filesize = 2M/upload_max_filesize = 128M/g&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">php.ini</span></span>
<span class="line"><span style="color:#DCDCAA;">sed</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-i</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;s/post_max_size = 8M/post_max_size = 256M/g&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">php.ini</span></span>
<span class="line"><span style="color:#DCDCAA;">sed</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-i</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;s/memory_limit = 128M/memory_limit = 512M/g&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">php.ini</span></span>
<span class="line"><span style="color:#DCDCAA;">exit</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后重启 WordPress 镜像：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">docker</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">restart</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">wordpress</span></span>
<span class="line"></span></code></pre></div><p>现在已经配置完成了，打开地址即可访问，上传限制也可以该为你设定的其他值。</p><h2 id="_3-wordpress-容器内安装软件" tabindex="-1"><a class="header-anchor" href="#_3-wordpress-容器内安装软件" aria-hidden="true">#</a> 3. WordPress 容器内安装软件</h2><p>进入容器：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">docker</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">exec</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-it</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">wordpress</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">/bin/bash</span></span>
<span class="line"></span></code></pre></div><p>下面的操作都在容器中进行。</p><p>先修改软件镜像源，可以使用下面的命令修改为清华源（当前最新的 WordPress 是基于 Debian 11，其他版本参考其他镜像地址）：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">mv</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">/etc/apt/sources.list</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">/etc/apt/sources.list-bak</span></span>
<span class="line"><span style="color:#DCDCAA;">echo</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;</span></span>
<span class="line"><span style="color:#CE9178;">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye main contrib non-free</span></span>
<span class="line"><span style="color:#CE9178;">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-updates main contrib non-free</span></span>
<span class="line"><span style="color:#CE9178;">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bullseye-backports main contrib non-free</span></span>
<span class="line"><span style="color:#CE9178;">deb https://mirrors.tuna.tsinghua.edu.cn/debian-security bullseye-security main contrib non-free</span></span>
<span class="line"><span style="color:#CE9178;">&#39;</span><span style="color:#D4D4D4;"> &gt; </span><span style="color:#CE9178;">/etc/apt/sources.list</span></span>
<span class="line"></span></code></pre></div><p>测试安装 <code>vim</code>：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">apt</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">install</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-y</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">vim</span></span>
<span class="line"></span></code></pre></div>`,22);function C(u,v){const a=o("router-link");return r(),c("div",null,[i,s("nav",d,[s("ul",null,[s("li",null,[l(a,{to:"#_1-docker-创建容器"},{default:p(()=>[n("1. Docker 创建容器")]),_:1})]),s("li",null,[l(a,{to:"#_2-修改最大上传限制"},{default:p(()=>[n("2. 修改最大上传限制")]),_:1})]),s("li",null,[l(a,{to:"#_3-wordpress-容器内安装软件"},{default:p(()=>[n("3. WordPress 容器内安装软件")]),_:1})])])]),y])}const b=e(t,[["render",C],["__file","install-wordpress.html.vue"]]);export{b as default};
