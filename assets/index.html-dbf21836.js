import{_ as l,r as e,o as p,c as o,b as s,d as a,a as c,e as i}from"./app-cc07cb32.js";const t={},r=s("h1",{id:"git-高级",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#git-高级","aria-hidden":"true"},"#"),a(" Git 高级")],-1),d=s("h2",{id:"_1-忽略文件",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-忽略文件","aria-hidden":"true"},"#"),a(" 1. 忽略文件")],-1),D=s("p",null,"有些时候，你必须把某些文件放到 Git 工作目录中，但又不能提交它们，比如保存了数据库密码的配置文件。",-1),y=s("p",null,[a("在 Git 工作区的根目录下创建一个 "),s("code",null,".gitignore"),a(" 文件，然后把要忽略的文件名填进去，Git 就会自动忽略这些文件。")],-1),h={class:"hint-container info"},u=s("p",{class:"hint-container-title"},"最佳实践",-1),g=s("code",null,".gitignore",-1),b={href:"https://github.com/github/gitignore",target:"_blank",rel:"noopener noreferrer"},v=i(`<p>忽略文件的原则是：</p><ol><li>忽略操作系统自动生成的文件，比如缩略图等</li><li>忽略编译生成的中间文件、可执行文件等，也就是如果一个文件是通过另一个文件自动生成的，那自动生成的文件就没必要放进版本库，比如 Java 编译产生的 <code>.class</code> 文件</li><li>忽略你自己的带有敏感信息的配置文件，比如存放口令的配置文件</li></ol><p>可以使用通配符确定文件或文件夹的名称：</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#6A9955;"># Windows 下自动生成</span></span>
<span class="line"><span style="color:#D4D4D4;">Thumbs.db</span></span>
<span class="line"><span style="color:#D4D4D4;">ehthumbs.db</span></span>
<span class="line"><span style="color:#D4D4D4;">Desktop.ini</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># Mac 下自动生成</span></span>
<span class="line"><span style="color:#D4D4D4;">.DS_Store</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># 编译目标</span></span>
<span class="line"><span style="color:#D4D4D4;">dist</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># 编译中间结果</span></span>
<span class="line"><span style="color:#D4D4D4;">*.py[cdo]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># 其他配置文件和二进制文件</span></span>
<span class="line"><span style="color:#D4D4D4;">*.so</span></span>
<span class="line"><span style="color:#D4D4D4;">*.egg</span></span>
<span class="line"><span style="color:#D4D4D4;">*.egg-info</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># 秘钥等信息</span></span>
<span class="line"><span style="color:#D4D4D4;">secret_key.key</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果你的文件被 <code>.gitignore</code> 忽略了，可以使用下面的命令强制加入，这不是推荐做法：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">add</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-f</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">Application.class</span></span>
<span class="line"></span></code></pre></div><p>使用 <code>git check-ignore</code> 检查规则是否有错误：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">check-ignore</span></span>
<span class="line"></span></code></pre></div><p>如果不希望使用强制添加，又希望有例外情况使用 <code>!</code> 加入即可：</p><div class="language-properties" data-ext="properties"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;">!.gitignore</span></span>
<span class="line"><span style="color:#D4D4D4;">!Application.class</span></span>
<span class="line"></span></code></pre></div><h2 id="_2-放弃提交" tabindex="-1"><a class="header-anchor" href="#_2-放弃提交" aria-hidden="true">#</a> 2. 放弃提交</h2><p>放弃上一次提交：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">reset</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--soft</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">HEAD^</span></span>
<span class="line"><span style="color:#6A9955;"># 或者可以</span></span>
<span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">reset</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--soft</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">HEAD~1</span></span>
<span class="line"></span></code></pre></div><p>放弃若干次提交，<code>~</code> 后的数字代表你想放弃的次数：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">reset</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--soft</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">HEAD~2</span></span>
<span class="line"></span></code></pre></div><details class="hint-container details"><summary>放弃提交示例</summary><p>放弃提交，保留 Add：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">reset</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--soft</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">HEAD^</span></span>
<span class="line"></span></code></pre></div><p>暂存修改：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">stash</span></span>
<span class="line"></span></code></pre></div><p>签出历史提交：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">checkout</span><span style="color:#D4D4D4;"> &lt;</span><span style="color:#CE9178;">commit_i</span><span style="color:#D4D4D4;">d&gt;</span></span>
<span class="line"></span></code></pre></div><p>最后恢复工作进度：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">stash</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">pop</span></span>
<span class="line"></span></code></pre></div></details><h2 id="_3-高级克隆" tabindex="-1"><a class="header-anchor" href="#_3-高级克隆" aria-hidden="true">#</a> 3. 高级克隆</h2><h3 id="_3-1-指定克隆深度" tabindex="-1"><a class="header-anchor" href="#_3-1-指定克隆深度" aria-hidden="true">#</a> 3.1 指定克隆深度</h3><p><code>--depth</code> 选项用于指定克隆深度，即保留之前多少次提交，一般克隆项目只用于测试或部署而不需要开发，就不需要保留历史，因为克隆历史需要占用大量网络资源，也会占用不必要的空间：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">clone</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--depth</span><span style="color:#D4D4D4;"> </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">https://github.com/python/cpython.git</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-2-指定分支" tabindex="-1"><a class="header-anchor" href="#_3-2-指定分支" aria-hidden="true">#</a> 3.2 指定分支</h3><p><code>--branch</code> 用于指定分支，如果只需要单个分支也可以使用 <code>--single-branch</code> 选项，默认将选择 <code>origin</code> 分支。</p><h2 id="_4-指定标签" tabindex="-1"><a class="header-anchor" href="#_4-指定标签" aria-hidden="true">#</a> 4. 指定标签</h2><p>可以给某个提交号加标签，即将 tag 绑定到 commit 上：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">tag</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-a</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">v1.2</span><span style="color:#D4D4D4;"> </span><span style="color:#B5CEA8;">9</span><span style="color:#CE9178;">fceb02</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">-m</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;Release v1.2&quot;</span></span>
<span class="line"></span></code></pre></div><p>打上 tag 后需要将 tag 上传到远程仓库：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">push</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">origin</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">v1.2</span></span>
<span class="line"></span></code></pre></div><p>如果需要上传全部的 tag，可以一次性上传全部：</p><div class="language-bash" data-ext="sh"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">git</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">push</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">origin</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">--tags</span></span>
<span class="line"></span></code></pre></div>`,29);function E(C,k){const n=e("ExternalLinkIcon");return p(),o("div",null,[r,d,D,y,s("div",h,[u,s("p",null,[a("各种常用的 "),g,a(" 文件在 "),s("a",b,[a("GitHub"),c(n)]),a(" 可以参考，可以根据工程性质直接复制它们。另外有很多工程初始化就加上了这个文件，例如 Vue 项目创建时。")])]),v])}const m=l(t,[["render",E],["__file","index.html.vue"]]);export{m as default};
